<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">

    
    
        
    
    
    <title>node-libspotify - Flo.by</title>
    <!-- bootstrap -->
    <link rel="stylesheet" href="http://projects.flo.by/node-libspotify/bootstrap/css/bootstrap.css" type="text/css" media="screen" charset="utf-8">
    <link rel="stylesheet" href="http://projects.flo.by/node-libspotify/css/style.css" type="text/css" media="screen" charset="utf-8">
    <link rel="stylesheet" href="http://projects.flo.by/node-libspotify/css/pygments_style.css" type="text/css" media="screen" charset="utf-8">
    <script type="text/javascript">
      var _gaq = _gaq || [];
    </script>
</head>

<body>
    
        
    
    <div class="head">
        <div class="container">
        	<div class="row">
        		<div class="span12">
                    <p><em>This website is still under construction. Be advised!</em></p>
                </div>
        	</div>
        </div>
    </div>
    <div class="container banner">
        <div class="row">
            <div class="span2">
                <h1 class="floby-primary"><a href="http://www.flo.by/">Flo.by</a></h1>
            </div>
            <div class="span4 project">
                
                <h3 class="muted">node-libspotify</h3>
                
            </div>
            <div class="span6">
                
                
                    
                
                
                <ul class="nav nav-pills menu">
                    
                        <li class=""><a href="http://www.flo.by/">Home</a></li>
                    
                    
                        <li class="active"><a href="http://projects.flo.by/">Projects</a></li>
                    
                    <li class="disabled"><a rel="comingsoon" href="#">Work</a></li>
                    
                        <li><a target="_blank" onclick="javascript:_gaq.push(['_trackPageview', '/resume.pdf']);" href="http://www.flo.by/files/Florent-Jaby-CV.pdf">Resume</a></li>
                    
                </ul>
            </div>
        </div>
    </div><!-- .banner -->

    <div class="main">
         <div class="container">
    <div class="row">
        <hr />
        <div class="span8">
            <ul class="nav nav-tabs">
    
        
            <li><a href="http://projects.flo.by/node-libspotify/">Home</a></li>
        
    
        
            <li><a href="http://projects.flo.by/node-libspotify/download">Download</a></li>
        
    
        
            <li class="active"><a href="http://projects.flo.by/node-libspotify/quick-start">Quick Start</a></li>
        
    
        
            <li><a href="http://projects.flo.by/node-libspotify/readme">Read me</a></li>
        
    
</ul>

            <p>Because Spotify is far from being an open technology, there are certain limitations while using
this module. Namely:</p>

<ul>
<li>Only once session can live at once within the process</li>
<li>The user must have a Premium Spotify account</li>
<li>The developper must own a valid application key</li>
<li>Only a Premium Spotify user can get an application key</li>
</ul>

<h4>Getting a Spotify application key</h4>

<p>As I said just before, you can get a spotify application key only if you are yourself a premium spotify
user (9.90€/month). I like so spotify so it&#39;s not really a problem for me.</p>

<p>Go to <a href="https://developer.spotify.com/technologies/libspotify/keys/">My Keys</a>
and make sure you are logged in.
You should see your application key waiting to be downloaded. Download it as a file (Binary).</p>

<h4>Install libspotify</h4>

<p>Downloading and installing libspotify is fairly easy. I&#39;ll give you the steps for a *nix system.
Go to the <a href="https://developer.spotify.com/technologies/libspotify">Libspotify Homepage</a> 
and download the archive according to your system.</p>

<p>Extract it somewhere, go in that folder in a terminal and execute <code>make install</code> with admin rights.</p>

<h4>Finally getting to write some JS</h4>

<p>now that we&#39;re all set with the boring stuff, we&#39;re finally going to write some Javascript.</p>

<h5>Create a session and log in</h5>
<div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">sp</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;libspotify&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">session</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">sp</span><span class="p">.</span><span class="nx">Session</span><span class="p">({</span>
    <span class="nx">applicationKey</span><span class="o">:</span> <span class="s1">&#39;/path/to/spotify/application.key&#39;</span>
<span class="p">});</span>

<span class="nx">session</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;login&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;LOGGED IN TO SPOTIFY&#39;</span><span class="p">);</span>
<span class="p">})</span>
<span class="nx">session</span><span class="p">.</span><span class="nx">login</span><span class="p">(</span><span class="nx">login</span><span class="p">,</span> <span class="nx">password</span><span class="p">);</span>
</code></pre></div>
<p>As you can see logging in to spotify is fairly simple. Just create a session and call login with valid credentials.</p>

<h5>Search for tracks</h5>
<div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">search</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">sp</span><span class="p">.</span><span class="nx">Search</span><span class="p">(</span><span class="s2">&quot;Calvin Harris&quot;</span><span class="p">);</span>
<span class="nx">search</span><span class="p">.</span><span class="nx">trackCount</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span> <span class="c1">// get the 10 first results</span>
<span class="nx">search</span><span class="p">.</span><span class="nx">execute</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">search</span><span class="p">.</span><span class="nx">tracks</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>
<p>With node-libspotify, a search query is an object which you configure and then execute. You can alternatively listen
to the <code>ready</code> event.</p>

<h5>Get a track from its spotify URL</h5>
<div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">track</span> <span class="o">=</span> <span class="nx">sp</span><span class="p">.</span><span class="nx">Track</span><span class="p">.</span><span class="nx">getFromUrl</span><span class="p">(</span><span class="s1">&#39;spotify:track:2Uqs7Gi9F0BHg3H7yhbpWm&#39;</span><span class="p">);</span>
<span class="nx">track</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;ready&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">track</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div>
<p>In this example appears an important aspect of node-libspotify. Nearly all objects are loaded asynchronously. This means
that in this case, the <code>track</code> oject is just a placeholder at first and then gets populated with data. The <code>ready</code> event
is triggered when these data are loaded.</p>

<h5>Stream a track from spotify</h5>
<div class="highlight"><pre><code class="javascript"><span class="kd">var</span> <span class="nx">player</span> <span class="o">=</span> <span class="nx">session</span><span class="p">.</span><span class="nx">getPlayer</span><span class="p">();</span>
<span class="nx">player</span><span class="p">.</span><span class="nx">load</span><span class="p">(</span><span class="nx">track</span><span class="p">);</span>
<span class="nx">player</span><span class="p">.</span><span class="nx">play</span><span class="p">();</span>
<span class="nx">player</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">buffer</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// buffer.length is the length of the buffer as usual</span>
    <span class="c1">// buffer.rate is the sample rate of the audio data in this buffer</span>
    <span class="c1">// buffer.channels is the number of channels of the audio data (usually 2 for stereo)</span>
    <span class="c1">// Samples are 16 bit signed integers</span>
<span class="p">});</span>
</code></pre></div>
<p>As you can see, libspotify only feeds the client with raw audio data. All processing and decompressing is done by libspotify
under the hood. You can see an example of how to actually play music from spotify in the
<a href="http://github.com/Floby/node-libspotify/blob/master/example/play.js">example folder</a>
of the repository</p>

        </div>
        <div class="span2 offset2 ">
            <img src="http://projects.flo.by/node-libspotify/images/node-libspotify-icon.png" />
        </div>
    </div>
</iiv>

    </div>
    <div class="container footer">
        <hr />
        <div class="row">
            <div class="span3 aknowledgement">
                <em>Website created using <a href="http://twitter.github.com/bootstrap">Twitter Bootstrap</a></em>
            </div>
            <div class="span2 offset4">
                
                <i>Last updated: 26 Jan 2013</i>
                
            </div>
            <div class="span3 copyright">
                <em>Copyright © 2013 Florent Jaby</em>
            </div>
        </div>
    </div><!-- .footer -->
    <script type="text/javascript" charset="utf-8" src="http://code.jquery.com/jquery-latest.js"></script>
    <script type="text/javascript" charset="utf-8" src="http://projects.flo.by/node-libspotify/bootstrap/js/bootstrap.js"></script>
    <script type="text/javascript" charset="utf-8" src="http://projects.flo.by/node-libspotify/js/prefixfree.min.js"></script>
    <script type="text/javascript" charset="utf-8">
        $('[rel=tooltip]').tooltip();
        $('[rel=comingsoon]').tooltip({
            title: 'Coming soon!',
            placement: 'bottom'
        });
        $(function() {
            setTimeout(function() {
                $(document.body).addClass('loaded');
            }, 100);
        })
    </script>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-37756010-1']);
  _gaq.push(['_setDomainName', window.location.hostname]);

  if(window._flobyVirtualPageName) {
      _gaq.push(['_trackPageview', window._flobyVirtualPageName]);
  }
  else {
      _gaq.push(['_trackPageview']);
  }

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</body>

</html>

